<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<!-- Basic -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Site Metas -->
    <title>ThewayShop - Ecommerce Bootstrap 4 HTML Template</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

</head>

<body>

<div th:include="fragment/header :: body"></div>

<!-- Start All Title Box -->
<div class="all-title-box">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h2>Checkout</h2>
                <ul class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Shop</a></li>
                    <li class="breadcrumb-item active">Checkout</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- End All Title Box -->

<!-- Start Cart  -->
<div class="cart-box-main">
    <div class="container">
        <!--        <div class="row new-account-login">-->
        <!--            <div class="col-sm-6 col-lg-6 mb-3">-->
        <!--                <div class="title-left">-->
        <!--                    <h3>Account Login</h3>-->
        <!--                </div>-->
        <!--                <h5><a data-toggle="collapse" href="/login" role="button" aria-expanded="false">Click here to Login</a>-->
        <!--                </h5>-->
        <!--                <div class="mt-3 collapse review-form-box" id="formLogin">-->
        <!--                    <div class="form-row">-->
        <!--                        <div class="form-group col-md-6">-->
        <!--                            <label for="InputEmail" class="mb-0">Email Address</label>-->
        <!--                            <input type="email" class="form-control" id="InputEmail" placeholder="Enter Email"></div>-->
        <!--                        <div class="form-group col-md-6">-->
        <!--                            <label for="InputPassword" class="mb-0">Password</label>-->
        <!--                            <input type="password" class="form-control" id="InputPassword" placeholder="Password"></div>-->
        <!--                    </div>-->
        <!--                    <button type="submit" class="btn hvr-hover">Login</button>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--            <div class="col-sm-6 col-lg-6 mb-3">-->
        <!--                <div class="title-left">-->
        <!--                    <h3>Create New Account</h3>-->
        <!--                </div>-->
        <!--                <h5><a data-toggle="collapse" href="#formRegister" role="button" aria-expanded="false">Click here to-->
        <!--                    Register</a></h5>-->
        <!--                <div class="mt-3 collapse review-form-box" id="formRegister">-->
        <!--                    <div class="form-row">-->
        <!--                        <div class="form-group col-md-6">-->
        <!--                            <label for="InputName" class="mb-0">First Name</label>-->
        <!--                            <input type="text" class="form-control" id="InputName" placeholder="First Name"></div>-->
        <!--                        <div class="form-group col-md-6">-->
        <!--                            <label for="InputLastname" class="mb-0">Last Name</label>-->
        <!--                            <input type="text" class="form-control" id="InputLastname" placeholder="Last Name"></div>-->
        <!--                        <div class="form-group col-md-6">-->
        <!--                            <label for="InputEmail1" class="mb-0">Email Address</label>-->
        <!--                            <input type="email" class="form-control" id="InputEmail1" placeholder="Enter Email"></div>-->
        <!--                        <div class="form-group col-md-6">-->
        <!--                            <label for="InputPassword1" class="mb-0">Password</label>-->
        <!--                            <input type="password" class="form-control" id="InputPassword1" placeholder="Password">-->
        <!--                        </div>-->
        <!--                    </div>-->
        <!--                    <button type="submit" class="btn hvr-hover">Register</button>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--        </div>-->
        <form th:action="@{/checkout/order}" th:object="${placeOrderForm}" method="post"
              enctype="multipart/form-data">
            <div class="row">
                <div class="col-sm-6 col-lg-6 mb-3">
                    <div class="checkout-address">
                        <div class="title-left">
                            <h3>Billing address</h3>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName">First name *</label>
                                <input type="text" class="form-control" id="firstName" placeholder=""
                                       name="firstName" th:value="${appUser != null?appUser.firstName:''}" required>
                                <div class="invalid-feedback"> Valid first name is required.</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName">Last name *</label>
                                <input type="text" class="form-control" id="lastName" placeholder=""
                                       name="lastName" th:value="${appUser!=null?appUser.lastName:''}" required>
                                <div class="invalid-feedback"> Valid last name is required.</div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="username">Username *</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="username" placeholder=""
                                       th:value="${appUser!=null?appUser.email:''}" required>
                                <div class="invalid-feedback" style="width: 100%;"> Your username is required.</div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="email">Email Address *</label>
                            <input type="email" class="form-control" id="email" placeholder=""
                                   name="email" th:value="${appUser!=null?appUser.email:''}" required>
                            <div class="invalid-feedback"> Please enter a valid email address for shipping updates.</div>
                        </div>
                        <div class="mb-3">
                            <label for="address">Address *</label>
                            <input type="text" class="form-control" id="address" placeholder=""
                                   name="address" th:value="${appUser!=null?appUser.address:''}" required>
                            <div class="invalid-feedback"> Please enter your shipping address.</div>
                        </div>
                        <div class="mb-3">
                            <label for="phoneNumber">Phone Number *</label>
                            <input type="text" class="form-control" id="phoneNumber" placeholder=""
                                   name="phoneNumber" th:value="${appUser!=null?appUser.phoneNumber:''}" required>
                            <div class="invalid-feedback"> Please enter your phone number.</div>
                        </div>
                        <!--                            <div class="row">-->
                        <!--                                <div class="col-md-5 mb-3">-->
                        <!--                                    <label for="country">Country *</label>-->
                        <!--                                    <select class="wide w-100" id="country">-->
                        <!--                                        <option value="Choose..." data-display="Select">Choose...</option>-->
                        <!--                                        <option value="United States">United States</option>-->
                        <!--                                    </select>-->
                        <!--                                    <div class="invalid-feedback"> Please select a valid country.</div>-->
                        <!--                                </div>-->
                        <!--                                <div class="col-md-4 mb-3">-->
                        <!--                                    <label for="state">State *</label>-->
                        <!--                                    <select class="wide w-100" id="state">-->
                        <!--                                        <option data-display="Select">Choose...</option>-->
                        <!--                                        <option>California</option>-->
                        <!--                                    </select>-->
                        <!--                                    <div class="invalid-feedback"> Please provide a valid state.</div>-->
                        <!--                                </div>-->
                        <!--                                <div class="col-md-3 mb-3">-->
                        <!--                                    <label for="zip">Zip *</label>-->
                        <!--                                    <input type="text" class="form-control" id="zip" placeholder="" required>-->
                        <!--                                    <div class="invalid-feedback"> Zip code required.</div>-->
                        <!--                                </div>-->
                        <!--                            </div>-->
                        <hr class="mb-4">
<!--                        <div class="custom-control custom-checkbox">-->
<!--                            <input type="checkbox" class="custom-control-input" id="same-address">-->
<!--                            <label class="custom-control-label" for="same-address">Shipping address is the same as my billing address</label>-->
<!--                        </div>-->
<!--                        <div class="custom-control custom-checkbox">-->
<!--                            <input type="checkbox" class="custom-control-input" id="save-info">-->
<!--                            <label class="custom-control-label" for="save-info">Save this information for next-->
<!--                                time</label>-->
<!--                        </div>-->
<!--                        <hr class="mb-4">-->
                        <div class="title">
                            <span>Payment</span></div>
                        <div class="d-block my-3">
                            <div class="custom-control custom-radio">
                                <input id="payAfter" name="paymentMethod" type="radio" class="custom-control-input"
                                       value="0" checked required>
                                <label class="custom-control-label" for="payAfter">Pay after receive product</label>
                            </div>
<!--                            <div class="custom-control custom-radio">-->
<!--                                <input id="credit" name="paymentMethod" type="radio" class="custom-control-input"-->
<!--                                       value="1" onclick="showPayment(this)" required>-->
<!--                                <label class="custom-control-label" for="credit">Credit card</label>-->
<!--                            </div>-->
<!--                            <div class="custom-control custom-radio">-->
<!--                                <input id="debit" name="paymentMethod" type="radio" class="custom-control-input"-->
<!--                                       value="2" onclick="showPayment(this)" required>-->
<!--                                <label class="custom-control-label" for="debit">Debit card</label>-->
<!--                            </div>-->
                            <div class="custom-control custom-radio">
                                <input id="paypal" name="paymentMethod" type="radio" class="custom-control-input"
                                       value="3" required>
                                <label class="custom-control-label" for="paypal">Paypal</label>
                            </div>
                        </div>
<!--                        <div id="informationPayment" style="display: none">-->
<!--                            <div class="row">-->
<!--                                <div class="col-md-6 mb-3">-->
<!--                                    <label for="cc-name">Name on card</label>-->
<!--                                    <input type="text" class="form-control" id="cc-name" placeholder="">-->
<!--                                    <small class="text-muted">Full name as displayed on card</small>-->
<!--                                    <div class="invalid-feedback"> Name on card is required</div>-->
<!--                                </div>-->
<!--                                <div class="col-md-6 mb-3">-->
<!--                                    <label for="cc-number">Credit card number</label>-->
<!--                                    <input type="text" class="form-control" id="cc-number" placeholder="">-->
<!--                                    <div class="invalid-feedback"> Credit card number is required</div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="row">-->
<!--                                <div class="col-md-3 mb-3">-->
<!--                                    <label for="cc-expiration">Expiration</label>-->
<!--                                    <input type="text" class="form-control" id="cc-expiration" placeholder="">-->
<!--                                    <div class="invalid-feedback"> Expiration date required</div>-->
<!--                                </div>-->
<!--                                <div class="col-md-3 mb-3">-->
<!--                                    <label for="cc-expiration">CVV</label>-->
<!--                                    <input type="text" class="form-control" id="cc-cvv" placeholder="">-->
<!--                                    <div class="invalid-feedback"> Security code required</div>-->
<!--                                </div>-->
<!--                                <div class="col-md-6 mb-3">-->
<!--                                    <div class="payment-icon">-->
<!--                                        <ul>-->
<!--                                            <li><img class="img-fluid" src="images/payment-icon/1.png" alt=""></li>-->
<!--                                            <li><img class="img-fluid" src="images/payment-icon/2.png" alt=""></li>-->
<!--                                            <li><img class="img-fluid" src="images/payment-icon/3.png" alt=""></li>-->
<!--                                            <li><img class="img-fluid" src="images/payment-icon/5.png" alt=""></li>-->
<!--                                            <li><img class="img-fluid" src="images/payment-icon/7.png" alt=""></li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
                        <hr class="mb-1">
                    </div>
                </div>
                <div class="col-sm-6 col-lg-6 mb-3">
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div class="shipping-method-box">
                                <div class="title-left">
                                    <h3>Shipping Method</h3>
                                </div>
                                <div class="mb-4">
                                    <div class="custom-control custom-radio">
                                        <input id="shippingOption1" name="shippingMethod" class="custom-control-input"
                                               checked="checked" type="radio" value="0" onclick="getGrandTotal(this)">
                                        <label class="custom-control-label" for="shippingOption1">Standard
                                            Delivery</label>
                                        <span class="float-right font-weight-bold">FREE</span></div>
                                    <div class="ml-4 mb-2 small">(3-7 business days)</div>
                                    <div class="custom-control custom-radio">
                                        <input id="shippingOption2" name="shippingMethod" class="custom-control-input"
                                               type="radio" value="10" onclick="getGrandTotal(this)">
                                        <label class="custom-control-label" for="shippingOption2">Express
                                            Delivery</label>
                                        <span class="float-right font-weight-bold">$10.00</span></div>
                                    <div class="ml-4 mb-2 small">(2-4 business days)</div>
                                    <div class="custom-control custom-radio">
                                        <input id="shippingOption3" name="shippingMethod" class="custom-control-input"
                                               type="radio" value="20" onclick="getGrandTotal(this)">
                                        <label class="custom-control-label" for="shippingOption3">Next Business
                                            day</label>
                                        <span class="float-right font-weight-bold">$20.00</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 col-lg-12">
                            <input type="hidden" th:value="${cart.id}" id="cartId" name="cartId">
                            <div class="odr-box">
                                <div class="title-left">
                                    <h3>Shopping cart</h3>
                                </div>
                                <div class="rounded p-2 bg-light" th:each="item: ${cartItems}">
                                    <div class="media mb-2 border-bottom">
                                        <div class="media-body">
                                            <a th:href="|/products/view/${item.product.id}|"
                                               th:text="${item.product.name}"></a>
                                            <div class="small text-muted">
                                                <span class="mx-2" th:text="|Price: $ ${item.product.price} |"></span>
                                                <span class="mx-2" th:text="|Qty: ${item.quantity} |"></span>
                                                <span class="mx-2"
                                                      th:text="|Subtotal: $ ${item.quantity*item.product.price} |"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 col-lg-12">
                            <div class="order-box">
                                <div class="title-left">
                                    <h3>Your order</h3>
                                </div>
                                <div class="d-flex">
                                    <div class="font-weight-bold">Product</div>
                                    <div class="ml-auto font-weight-bold">Total</div>
                                </div>
                                <hr class="my-1">
                                <div class="d-flex">
                                    <h4>Sub Total</h4>
                                    <div class="ml-auto font-weight-bold" id="subTotal"
                                         th:utext="|$ ${totalPrice}|"></div>
                                    <input type="hidden" name="subTotal" th:value="${totalPrice}">
                                </div>
                                <div class="d-flex">
                                    <h4>Discount</h4>
                                    <div class="ml-auto font-weight-bold" name="discount">0</div>
                                    <input type="hidden" name="discount" value="0">
                                </div>
                                <hr class="my-1">
                                <div class="d-flex">
                                    <h4>Coupon Discount</h4>
                                    <div class="ml-auto font-weight-bold">0</div>
                                </div>
                                <div class="d-flex">
                                    <h4>Tax</h4>
                                    <div class="ml-auto font-weight-bold">0</div>
                                    <input type="hidden" name="tax" value="0">
                                </div>
                                <div class="d-flex">
                                    <h4>Shipping Cost</h4>
                                    <div class="ml-auto font-weight-bold" id="shippingCost">Free</div>
                                </div>
                                <hr>
                                <div class="d-flex gr-total">
                                    <h5>Grand Total</h5>
                                    <div class="ml-auto h5" id="grandTotal"
                                         th:utext="|$ ${totalPrice}|"></div>
                                    <input type="hidden" name="grandTotal" th:value="${totalPrice}">
                                </div>
                                <hr>
                            </div>
                        </div>
                        <div class="col-12 d-flex shopping-box">
                            <button type="submit" class="ml-auto btn hvr-hover" style="color: white"
                                    onclick="return confirm('Confirm checkout')">Place Order
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

    </div>
</div>
<!-- End Cart -->

<div th:include="fragment/footer :: body"></div>
</body>

<script th:inline="javascript">
    /*<![CDATA[*/
    function showPayment(element) {
        if (element.value == 0) {
            $("#informationPayment").hide();
        } else {
            $("#informationPayment").show();
        }
    }

    function getGrandTotal(element) {
        let subPrice = parseInt($("#subTotal").html().replace("$ ",""));
        let grandTotal = subPrice + parseInt(element.value);

        if (grandTotal > 0) {
            document.getElementById("grandTotal").innerText = "$ " + grandTotal;
        } else {
            document.getElementById("grandTotal").innerText = "$ 0";
        }

        if (element.value == 0) {
            document.getElementById("shippingCost").innerText = "Free";
        } else {
            document.getElementById("shippingCost").innerText = "$ " + element.value;
        }
    }

    /*]]>*/
</script>

</html>